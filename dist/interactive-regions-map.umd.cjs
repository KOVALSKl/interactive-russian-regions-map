(function(l,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("d3")):typeof define=="function"&&define.amd?define(["exports","vue","d3"],e):(l=typeof globalThis<"u"?globalThis:l||self,e(l.InteractiveRegionsMap={},l.Vue,l.d3))})(this,function(l,e,j){"use strict";function E(i){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const d=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(s,t,d.get?d:{enumerable:!0,get:()=>i[t]})}}return s.default=i,Object.freeze(s)}const a=E(j),P={class:"map-region"},I=["d"],R={props:["d","data"],emits:["regionClicked"],setup(i,{emit:s}){const t=i;return(d,g)=>(e.openBlock(),e.createElementBlock("g",P,[e.createElementVNode("path",{class:"map-region-path",d:t.d,onClick:g[0]||(g[0]=u=>s("regionClicked",{event:u,data:i.data}))},null,8,I)]))}},B={class:"map-container w-100"},M=["width","height","transform","viewBox"],z={id:"regions-container"},N=e.createElementVNode("path",{fill:"none",stroke:"white","stroke-linejoin":"round"},null,-1),O={props:{width:{type:Number,default:900},height:{type:Number,default:900},regions:{type:Object,required:!0},regionsIndexes:{type:Object,default:null},mapProjection:{type:Object,default:null},animationDurationTime:{type:Number,default:1500}},emits:["nextRegion","previousRegion"],setup(i,{emit:s}){const t=i,d=t.regions.features.length;let g=[],u=new Map;const T=e.computed(()=>t.mapProjection??a.geoTransverseMercator().fitSize([t.width,t.height],t.regions).rotate([-90,0]).center([-20,-20])),c=e.ref(0),_=e.ref(a.geoPath().projection(T.value)),D=e.ref(null),f=e.ref(null),m=e.ref(null),x=e.ref(null);e.ref(null);const h=e.computed(()=>t.regions.features[c.value]);e.watch(c,(n,o)=>{console.log(`index was changed ${n}`),h.value=t.regions.features[n]}),e.watch(h,(n,o)=>{var r,p;(r=u.get(o.properties.id))==null||r.style.setProperty("fill",null),(p=u.get(n.properties.id))==null||p.style.setProperty("fill","red")});function y(n){n>=0&&n<d&&(c.value=n,console.log(`value updated: ${c.value}`))}function S(n){for(let o=0;o<d;o++)if(t.regions[o].properties.id===n.properties.id)return o}function $(n){let o=n.properties.id;return t.regionsIndexes[o].index}function C(){console.log("clicked next"),y(++c.value),console.log(c.value),w(),s("nextRegion")}function q(){console.log("clicked previous"),y(--c.value),console.log(c.value),w(),s("previousRegion")}function w(){let n=h.value.properties.id;u.get(n).dispatchEvent(new PointerEvent("click",void 0))}function V(n){const{transform:o}=n;x.value.attr("transform",o),x.value.attr("stroke-width",1/o.k)}function A(){m.value.transition().duration(t.animationDurationTime).call(f.value.transform,a.zoomIdentity,a.zoomTransform(m.value.node()).invert([t.width/2,t.height/2]))}function F({event:n,data:o}){console.log(n);const[[r,p],[v,b]]=_.value.bounds(o);n.stopPropagation();let k;console.log(o),t.regionsIndexes?k=$(o):k=S(o),console.log(k),y(k),m.value.transition().duration(t.animationDurationTime).call(f.value.transform,a.zoomIdentity.translate(t.width/2,t.height/2).scale(Math.min(8,.9/Math.max((v-r)/t.width,(b-p)/t.height))).translate(-(r+v)/2,-(p+b)/2))}return e.onMounted(()=>{f.value=a.zoom().scaleExtent([1,8]).on("zoom",V),m.value=a.select("svg").on("click",A).call(f.value),g=document.querySelectorAll("path.map-region-path").values();for(let n of g)u.set(n.parentElement.id,n);x.value=a.select("#regions-container"),w()}),(n,o)=>(e.openBlock(),e.createElementBlock("div",B,[(e.openBlock(),e.createElementBlock("svg",{id:"map",width:t.width,height:t.height,transform:D.value,viewBox:[0,0,t.width,t.height]},[e.createElementVNode("g",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.regions.features,r=>(e.openBlock(),e.createBlock(R,{key:r.properties.NAME_1,id:r.properties.id,ref_for:!0,ref:"regionsRef",data:r,d:_.value(r),onRegionClicked:F},null,8,["id","data","d"]))),128)),N])],8,M)),e.renderSlot(n.$slots,"default",{regionData:e.unref(h),onNextRegion:C,onPreviousRegion:q})]))}};l.MapRegion=R,l.RegionsMap=O,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
