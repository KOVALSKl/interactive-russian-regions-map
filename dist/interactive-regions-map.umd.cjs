(function(a,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("d3")):typeof define=="function"&&define.amd?define(["exports","vue","d3"],t):(a=typeof globalThis<"u"?globalThis:a||self,t(a.InteractiveRegionsMap={},a.Vue,a.d3))})(this,function(a,t,x){"use strict";function E(i){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const e in i)if(e!=="default"){const c=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(l,e,c.get?c:{enumerable:!0,get:()=>i[e]})}}return l.default=i,Object.freeze(l)}const s=E(x),B={class:"map-region"},j=["d"],w={props:["d","data"],emits:["regionClicked"],setup(i,{emit:l}){const e=i;return(c,r)=>(t.openBlock(),t.createElementBlock("g",B,[t.createElementVNode("path",{class:"map-region-path",d:e.d,onClick:r[0]||(r[0]=d=>l("regionClicked",{event:d,data:i.data}))},null,8,j)]))}},P={class:"map-container w-100"},I=["width","height","viewBox"],R={id:"regions-container"},M=t.createElementVNode("path",{fill:"none",stroke:"white","stroke-linejoin":"round"},null,-1),v={props:{mapData:{type:Object,required:!0},path:{type:Function,required:!0},width:{type:Number,default:900},height:{type:Number,default:900}},emits:["regionClicked"],setup(i,{emit:l}){const e=i;return(c,r)=>(t.openBlock(),t.createElementBlock("div",P,[(t.openBlock(),t.createElementBlock("svg",{id:"map",width:e.width,height:e.height,viewBox:[0,0,e.width,e.height]},[t.createElementVNode("g",R,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(i.mapData.features,d=>(t.openBlock(),t.createBlock(w,{key:d.properties.NAME_1,id:d.properties.id,ref_for:!0,ref:"regionsRef",data:d,d:i.path(d),onRegionClicked:r[0]||(r[0]=p=>l("regionClicked",p))},null,8,["id","data","d"]))),128)),M])],8,I))]))}},C=(i,l)=>{const e=i.__vccOpts||i;for(const[c,r]of l)e[c]=r;return e},O={class:"map-provider-container"},N=C({props:{width:{type:Number,default:900},height:{type:Number,default:900},mapData:{type:Object,required:!0},mapDataIndexes:{type:Object,default:null},mapProjection:{type:Object,default:null},animationDurationTime:{type:Number,default:1500},color:{type:String,default:"red"}},emits:["nextRegion","previousRegion","regionClicked","mapClicked"],setup(i,{emit:l}){const e=i,c=e.mapData.features.length,r=new Map,d=t.computed(()=>e.mapProjection??s.geoTransverseMercator().fitSize([e.width,e.height],e.mapData).rotate([-90,0]).center([-20,-20])),p=t.computed(()=>e.mapData.features[g.value]),g=t.ref(0),_=t.ref(s.geoPath().projection(d.value)),h=t.ref(s.zoom().scaleExtent([1,8]).on("zoom",q)),f=t.ref(null),k=t.ref(null);t.watch(g,(n,o)=>{p.value=e.mapData.features[n]}),t.watch(p,(n,o)=>{var u,m;(u=r.get(o.properties.id))==null||u.style.setProperty("fill",null),(m=r.get(n.properties.id))==null||m.style.setProperty("fill",e.color)});function T(n){n>=0&&n<c&&(g.value=n)}function z(n){for(let o=0;o<c;o++)if(e.mapData[o].properties.id===n.properties.id)return o}function S(n){let o=n.properties.id;return e.mapDataIndexes[o].index}function $(){let n=p.value.properties.id;r.get(n).dispatchEvent(new PointerEvent("click",void 0))}function q(n){const{transform:o}=n;k.value.attr("transform",o),k.value.attr("stroke-width",1/o.k)}function V(){f.value.transition().duration(e.animationDurationTime).call(h.value.transform,s.zoomIdentity,s.zoomTransform(f.value.node()).invert([e.width/2,e.height/2]))}function F({event:n,data:o}){const[[u,m],[D,b]]=_.value.bounds(o);n.stopPropagation(),console.log(n,o);let y;e.mapDataIndexes?y=S(o):y=z(o),T(y),f.value.transition().duration(e.animationDurationTime).call(h.value.transform,s.zoomIdentity.translate(e.width/2,e.height/2).scale(Math.min(8,.9/Math.max((D-u)/e.width,(b-m)/e.height))).translate(-(u+D)/2,-(m+b)/2))}return t.onMounted(()=>{f.value=s.select("svg").on("click",V).call(h.value),k.value=s.select("#regions-container");const n=document.querySelectorAll("path.map-region-path").values();for(let o of n)r.set(o.parentElement.id,o);$()}),(n,o)=>(t.openBlock(),t.createElementBlock("div",O,[t.renderSlot(n.$slots,"map",{width:i.width,height:i.height,mapData:i.mapData,path:_.value,onRegionClicked:F},void 0,!0),t.renderSlot(n.$slots,"default",{},void 0,!0)]))}},[["__scopeId","data-v-77414b0a"]]);a.MapProvider=N,a.MapRegion=w,a.RegionsMap=v,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
